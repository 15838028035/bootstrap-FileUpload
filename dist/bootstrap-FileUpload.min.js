/*! Bootstrap FileUpload - v0.4.0 - 2016-05-17
* https://github.com/lleblanc42/bootstrap-FileUpload
* Copyright (c) 2016 Luke LeBlanc; Licensed GPL-3.0 */
!function(a,b,c,d){"use strict";function e(){var a=new XMLHttpRequest;return!!(c.FormData&&a&&"upload"in a&&"onprogress"in a.upload)}function f(a){return/((http(s)?|ftp(s)?):\/\/)?[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/.test(a)}function g(b){var d,e=a('<div class="alert alert-danger" role="alert"></div>');switch(b){case"url":d="The URL provided in the configuration is not a valid URL.";break;case"fallbackUrl":d="The Fallback URL provided in the configuration is not a valid URL.";break;case"formMethod":d="The Form Method provided in the configuration is not a valid, please choose either get or post in the configuration.";break;case"bootstrap":d="The Twitter Bootstrap API is not available on the current page. Please check to make sure all the dependencies are in place.";break;default:d="An unknown error occured."}options.debug===!1&&c.console&&c.console.error?c.console.error(d):options.debug===!0&&(e.append(d),wrapper.append(e))}a.fn.bootstrapFileUpload=function(b){var d,h,i,j,k,l,m,n,o,p,q,r,s={url:null,fallbackUrl:null,formMethod:"post",multiFile:!0,multiUpload:!1,inputName:"files",hiddenInput:null,forceFallback:!1,maxSize:5,maxFiles:null,showThumb:!0,thumbWidth:80,thumbHeight:80,fileTypes:{archives:[],audio:[],files:[],images:[],video:[]},debug:!0,onInit:function(){},onFileAdded:function(){},onFileRemoved:function(){},onFileCancel:function(){},onFileProcessing:function(){},onUploadProgress:function(){},onUploadError:function(){},onUploadSuccess:function(){},onUploadComplete:function(){},onUploadReset:function(){}},t=a.extend(s,b||{}),u={},v=0,w={},x=function(b){return d=a("#"+b),w.archives=["zip","7z","gz","gzip","rar","tar"],w.audio=["mp3","wav","wma","wpl","aac","flac","m4a","m4b","m4p","midi","ogg"],w.files=["doc","docx","docm","ods","odt","ott","ods","pdf","ppt","pptm","pptx","pub","rtf","csv","log","txt","xls","xlsm","xlsx"],w.images=["bmp","tif","tiff","gif","jpeg","jpg","png","svg","ico","raw"],w.video=["avi","flv","swf","m4v","mkv","mov","mp4","ogv","wmv"],G(),t.debug!==!0&&t.debug!==!1&&(t.debug=!0),"function"!=typeof a().emulateTransitionEnd?void g("bootstrap"):null!==t.url&&f(t.url)?"post"!==t.formMethod&&"get"!==t.formMethod?void g("formMethod"):null===t.fallbackUrl||f(t.fallbackUrl)?(e&&t.forceFallback===!1?y():z(),void("function"==typeof t.onInit&&t.onInit.call(this))):void g("fallbackUrl"):void g("url")},y=function(){r=new FormData,h=a('<form action="'+t.url+'" method="'+t.formMethod+'" enctype="multipart/form-data"></form>'),i=a('<div class="row fileupload-buttonbar"></div>'),j=a('<div class="col-lg-7"></div>'),k=a('<div class="btn btn-success fileupload-add"><input type="file" '+(t.multiFile===!0?'multiple="multiple"':void 0)+'multiple /><i class="glyphicon glyphicon-plus"></i>&nbsp;Add Files&hellip;</div>'),n=a('<button type="reset" class="btn btn-primary fileupload-reset"><i class="glyphicon glyphicon-repeat"></i>&nbsp;Add More Files&hellip;</button>'),l=a('<button class="btn btn-warning fileupload-start"><i class="glyphicon glyphicon-upload"></i>&nbsp;<span>Start upload</span></button>'),m=a('<button type="reset" class="btn btn-danger fileupload-cancel"><i class="glyphicon glyphicon-ban-circle"></i>&nbsp;<span>Cancel upload</span></button>'),o=a('<div class="col-lg-5 fileupload-overall-progress"><div class="progress"><div class="progress-bar progress-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%;"></div><div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%;"></div><div class="progress-extended">&nbsp;</div></div></div>'),p=a('<div class="row fileupload-overall-status"><div class="col-lg-12"><div class="alert alert-success"><strong>Uploaded Successfully!</strong></div><div class="alert alert-danger"></div></div></div>'),q=a('<table role="presentation" class="table table-striped fileupload-preview"><tbody class="files"></tbody></table>'),j.append(k,n,l,m),i.append(j,o),h.append(i,p),d.append(h,q),k.on("change","input",function(a){A(a)}),n.on("click",function(a){a.preventDefault(),E()}),l.on("click",function(a){a.preventDefault(),B()}),m.on("click",function(){E()}),q.on("click",".fileupload-remove",function(){D(a(this).val())})},z=function(){h=a('<form action="'+(t.fallbackUrl?t.fallbackUrl:t.url)+'" method="'+t.formMethod+'" enctype="multipart/form-data"></form>'),k=a('<div class="input-group"><span class="input-group-btn"><span class="btn btn-success fileupload-fallback-add"><i class="glyphicon glyphicon-plus"></i>&nbsp;Add Files&hellip; <input type="file" name="'+t.inputName+'" '+(t.multiFile===!0?'multiple="multiple"':void 0)+'></span></span><input type="text" class="form-control" readonly></div>'),l=a('<div class="form-group"><button type="submit" class="btn btn-warning fileupload-fallback-start"><i class="glyphicon glyphicon-upload"></i>&nbsp;<span>Start upload</span></button><button type="reset" class="btn btn-primary fileupload-fallback-reset"><i class="glyphicon glyphicon-repeat"></i>&nbsp;Reset</button></div>'),h.append(k,l),t.hiddenInput&&a.each(t.hiddenInput,function(a,b){h.append('<input type="hidden" name="'+a+'" value="'+b+'" />')}),d.append(h),k.on("change",".fileupload-fallback-add input[type=file]",function(){var b,c,d;b=a(this),c=b.get(0).files?b.get(0).files.length:1,d=b.val().replace(/\\/g,"/").replace(/.*\//,""),b.trigger("fileselect",[c,d])}),k.find(".fileupload-fallback-add input[type=file]").on("fileselect",function(b,c,d){var e,f;e=a(this).parents(".input-group").find("input[type=text]"),f=c>1?c+" files selected":d,e.length&&e.val(f)})},A=function(a){var b=a.target.files,e=b.length;t.multiFile===!0&&t.maxFiles&&e>t.maxFiles&&(c.alert("You're trying to upload "+e+" files and only "+t.maxFiles+" files is currently supported! The system will only upload what is supported and you will have to upload again."),e=t.maxFiles),q.detach();for(var f=0;e>f;f++){var g,h,i,j;if(g="file-"+f,h=b[f],i=h.size/1024/1024,H(h.type.split("/").pop().toLowerCase())!==!1)if(i.toFixed(2)>t.maxSize)c.alert('The file size for "'+h.name+'" is too large! Maximum supported file size is '+t.maxSize+"MB and the size of the file is "+i+"MB");else if(u&&F(h)>=0)c.alert('The file "'+h.name+'" is already in queue!');else{u[g]=h,v=++v,l.fadeIn("slow","linear"),m.fadeIn("slow","linear");var k='<div class="progress fileupload-progress"><div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%;"></div><div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%;"></div><div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%;"></div></div><div class="alert alert-success"><strong>Uploaded Successfully!</strong></div><div class="alert alert-danger"></div>';if(t.showThumb===!0){var n='<img src="'+URL.createObjectURL(h)+'" alt="'+h.name+'" width="'+t.thumbWidth+'px" height="'+t.thumbHeight+'px" class="fileupload-previewimg" />';j=t.multiUpload===!1?'<tr class="fileupload-previewrow thumb row" id="'+g+'"><td class="col-lg-1">'+n+'</td><td class="col-lg-4">'+h.name+'</td><td class="col-lg-6">'+k+'</td><td class="col-lg-1"><button class="btn btn-danger fileupload-remove" value="'+g+'"><i class="glyphicon glyphicon-ban-circle"></i>&nbsp;<span>Remove File</span></button></td></tr>':'<tr class="fileupload-previewrow thumb row" id="'+g+'"><td class="col-lg-1">'+n+'</td><td class="col-lg-9">'+h.name+'</td><td class="col-lg-2"><button class="btn btn-danger fileupload-remove" value="'+g+'"><i class="glyphicon glyphicon-ban-circle"></i>&nbsp;<span>Remove File</span></button></td></tr>'}else j=t.multiUpload===!1?'<tr class="fileupload-previewrow no-thumb row" id="'+g+'"><td class="col-lg-5">'+h.name+'</td><td class="col-lg-6">'+k+'</td><td class="col-lg-1"><button class="btn btn-danger fileupload-remove" value="'+g+'"><i class="glyphicon glyphicon-ban-circle"></i>&nbsp;<span>Remove File</span></button></td></tr>':'<tr class="fileupload-previewrow no-thumb row" id="'+g+'"><td class="col-lg-10">'+h.name+'</td><td class="col-lg-2"><button class="btn btn-danger fileupload-remove" value="'+g+'"><i class="glyphicon glyphicon-ban-circle"></i>&nbsp;<span>Remove File</span></button></td></tr>';q.append(j)}else c.alert('The file "'+h.name+'" is not a supported filetype!')}d.append(q),q.fadeIn("slow","linear"),"function"==typeof t.onFileAdded&&t.onFileAdded.call(this)},B=function(){a(".fileupload-add, .fileupload-start, .fileupload-cancel, .fileupload-remove").attr("disabled","disabled"),t.hiddenInput&&a.each(t.hiddenInput,function(a,b){r.append(a,b)}),t.multiUpload===!1?a.each(u,function(b,c){r.append(t.inputName,c),a("#"+b+" .fileupload-progress .progress-bar-striped").fadeIn("slow","linear"),a.ajax({url:t.url,type:t.formMethod,data:r,cache:!1,contentType:!1,processData:!1,accepts:"json",success:function(c,d,e){var f=JSON.parse(c);f.error?(a("#"+b+" .fileupload-progress .progress-bar-striped").attr("aria-valuenow",0).css("width","0%"),a("#"+b+" .fileupload-progress .progress-bar-danger").attr("aria-valuenow",100).css("width","100%"),a("#"+b+" .alert-danger").fadeIn("slow","linear").html("<strong>Error:</strong><br />"+f.error)):(a("#"+b+" .fileupload-progress .progress-bar-striped").attr("aria-valuenow",0).css("width","0%"),a("#"+b+" .fileupload-progress .progress-bar-success").attr("aria-valuenow",100).css("width","100%"),a("#"+b+" .alert-success").fadeIn("slow","linear")),"function"==typeof t.onUploadSuccess&&t.onUploadSuccess.call(this)},error:function(c,d,e){a("#"+b+" .fileupload-progress .progress-bar-striped").attr("aria-valuenow",0).css("width","0%"),a("#"+b+" .fileupload-progress .progress-bar-danger").attr("aria-valuenow",100).css("width","100%"),a("#"+b+" .alert-danger").fadeIn("slow","linear").html(d+": "+e.message),"function"==typeof t.onUploadError&&t.onUploadError.call(this)},xhr:function(){var c=a.ajaxSettings.xhr();return c.upload&&c.upload.addEventListener("progress",function(c){if(c.lengthComputable){var d=c.loaded/c.total;a("#"+b+" .fileupload-progress .progress-bar-striped").attr("aria-valuenow",Math.round(100*d)).css("width",Math.round(100*d)+"%")}}),c}}),"function"==typeof t.onUploadProgress&&t.onUploadProgress.call(this)}):(o.fadeIn("slow","linear"),a.each(u,function(a,b){r.append(t.inputName+"[]",b)}),a.ajax({url:t.url,type:t.formMethod,data:r,cache:!1,contentType:!1,processData:!1,accepts:"json",success:function(a,b,c){var d=JSON.parse(a);d.error?(o.find(".progress-bar-striped").attr("aria-valuenow",0).css("width","0%"),o.find(".progress-bar-danger").attr("aria-valuenow",100).css("width","100%"),p.fadeIn("slow","linear"),p.find(".alert-danger").fadeIn("slow","linear").html("<strong>Error:</strong><br />"+d.error)):(o.find(".progress-bar-striped").attr("aria-valuenow",0).css("width","0%"),o.find(".progress-bar-success").attr("aria-valuenow",100).css("width","100%"),p.fadeIn("slow","linear"),p.find(".alert-success").fadeIn("slow","linear")),"function"==typeof t.onUploadSuccess&&t.onUploadSuccess.call(this)},error:function(a,b,c){o.find(".progress-bar-striped").attr("aria-valuenow",0).css("width","0%"),o.find(".progress-bar-danger").attr("aria-valuenow",100).css("width","100%"),p.fadeIn("slow","linear"),p.find(".alert-danger").fadeIn("slow","linear").html(b+": "+c.message),"function"==typeof t.onUploadError&&t.onUploadError.call(this)},xhr:function(){var b=a.ajaxSettings.xhr();return b.upload&&b.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=a.loaded/a.total;o.find(".progress-bar-striped").attr("aria-valuenow",Math.round(100*b)).css("width",Math.round(100*b)+"%"),"function"==typeof t.onUploadProgress&&t.onUploadProgress.call(this)}}),b}})),k.fadeOut("slow","linear"),l.fadeOut("slow","linear"),m.fadeOut("slow","linear"),n.delay(600).fadeIn("slow","linear"),"function"==typeof t.onUploadComplete&&t.onUploadComplete.call(this)},C=function(){q.find("tbody").empty(),h[0].reset(),u={},v=0},D=function(b){1>=v?E():(a("#"+b).fadeOut("slow","linear"),a("#"+b+" .alert").fadeOut("slow","linear"),a("#"+b).remove(),delete u[b],v=--v),"function"==typeof t.onFileRemoved&&t.onFileRemoved.call(this)},E=function(){C(),q.fadeOut("slow","linear"),l.fadeOut("slow","linear"),m.fadeOut("slow","linear"),a(".fileupload-previewrow .alert").fadeOut("slow","linear"),a(".fileupload-add, .fileupload-start, .fileupload-cancel").removeAttr("disabled"),a(".fileupload-add").delay(800).fadeIn("slow","linear"),o.find(".progress-bar-success").attr("aria-valuenow",0).css("width","0%"),o.fadeOut("slow","linear"),n.fadeOut("slow","linear"),"function"==typeof t.onUploadReset&&t.onUploadReset.call(this)},F=function(b){var c=[];return a.each(u,function(a,b){c.push(b.name)}),a.inArray(b.name,c)},G=function(){a.isEmptyObject(t.fileTypes)?a.each(w,function(a,b){t.fileTypes[a]=b}):a.each(t.fileTypes,function(b,c){a.isNumeric(b)?t.fileTypes[c]=w[c]:!a.isNumeric(b)&&a.isEmptyObject(c)&&(t.fileTypes[b]=w[b])})},H=function(b){var c=!1;return a.each(t.fileTypes,function(d,e){return 0===a.inArray(b,e)?(c=!0,!1):void 0}),c};return this.each(function(){x(this.id)})}}(jQuery,document,window);